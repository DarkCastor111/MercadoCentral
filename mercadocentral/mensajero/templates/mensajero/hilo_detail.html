{% extends "core/layout.html" %}
{% load static %}

{% block titulo %}Hilo de conversación{% endblock %}

{% block navbar %}
{% include 'core/navbar.html' %}
{% endblock %}

{% block contenido %}
<style>
    .avatar {
        width: 50px;
        height: 50px;
        float: left;
        margin-right: 10px;
    }

    .thread {
        max-height: 300px;
        overflow-y: auto;
        padding: 0 0.5em;
    }

    .msg-mine {
        padding: 0 0.5em 0.25em;
        background-color: rgba(230, 242, 245, .5);
        width: 92%;
    }

    .msg-other {
        padding: 0 0.5em 0.25em;
        background-color: #f2f3f5;
        width: 92%;
        margin-left: 8%;
    }
</style>

<div class="col-md-8">
    <h4 class="mb-4">{{ hilo.print_presentacion }}</h4>
    <!-- Mostramos los mensajes en una capa que tiene un overflow vertical de 300 píxeles -->
    <div class="thread" id="thread">
        {% for msg in object.posts.all %}
        <!-- Dependiendo del usuario asignamos una clase con un color de fondo u otro en el mensaje -->
        {% if request.user == msg.author %}
        <div  class="msg-mine border mb-3">
        {% else %}
        <div  class="msg-other mb-3">
        {% endif %}
            <small>(<i>Hace {{msg.fecha_emision|timesince}}</i>) {{msg.author}} :     </small><br>
            {{msg.contenido}}
        </div>
        {% endfor %}
    </div>
    <form action="{% url 'mensajero:api_dejar_mensaje' %}" method="post">
        {% csrf_token %}
        <input type="hidden" name="form_pk_anuncio" value="{{ hilo.anuncio.id }}">
        <input type="hidden" name="form_pk_hilo" value="{{ hilo.id }}">

        <div class="row">
            <div class="col-8 pe-0">
                <textarea name="form_mensaje" cols="40" rows="3" class="form-control" required=""
                    placeholder="Mi mensaje" style="background-color: rgba(230, 242, 245, .5);"></textarea>
            </div>
            <div class="col-4">
                <button class="btn btn-secondary btn-sm m-1" type="submit">
                    Enviar Mensaje <i class="bi bi-arrow-right-circle"></i>
                </button>
            </div>
        </div>
    </form>
    <!--<h6 class="text-danger">Los mensajes enviados no generan notificaciones o correos => Recuerda chekear tus anuncios o tus favoritos</h6>-->

</div>


{% endblock %}